name: sharefile
on:
  workflow_dispatch:
    inputs:
      file_ID:
        description: 'google drive share file ID'
        required: true
        default: 'abc123456789012345678901234567890'

# env:
#   FILE_ID: 1HbaB7glgDTYWrE4ieBkX6uK0sT223hCl

jobs:
  downgdrive:
    runs-on: ubuntu-latest
    steps:
      -
        name: Checkout
        uses: actions/checkout@v2

      -
        name: downfromgdrive
        run: |
          sudo wget https://yt-dl.org/downloads/latest/youtube-dl -O /usr/local/bin/youtube-dl
          sudo chmod a+rx /usr/local/bin/youtube-dl
          sudo mkdir -p ./sharefiledir
          sudo chown $USER:$GROUPS ./sharefiledir 
          # cd  /sharefiledir 
          wget -P ./sharefiledir  https://drive.google.com/uc?id=${{ github.event.inputs.file_ID }}&export=download  
       
          

      -
        name: Upload firmware to WeTransfer
        run: |
          tar -czvf sharefiledir.tar.gz ./sharefiledir
          curl -fsSL git.io/file-transfer | sh
          ./transfer wet -s -p 16 --no-progress sharefiledir.tar.gz 2>&1 | tee wetransfer.log
          echo "::warning file=wetransfer.com::$(cat wetransfer.log | grep https)"
          echo "::set-output name=url::$(cat wetransfer.log | grep https | cut -f3 -d" ")"